/*! ng-http-rate-limiter 1.0.0 2016-05-21 - MIT Licensed, see http://github.com/bhollis/ng-http-rate-limiter */
!function(a,b){"undefined"!=typeof module&&module.exports?(b("undefined"==typeof angular?require("angular"):angular),module.exports="ngDialog"):"function"==typeof define&&define.amd?define(["angular"],b):b(a.angular)}(this,function(a){"use strict";a.module("ngHttpRateLimiter",[]).factory("ngHttpRateLimiterQueue",["$timeout","$window",function(b,c){function d(a,b,d){this.pattern=a,this.requestLimit=b,this.timeLimit=d||1e3,this.queue=[],this.count=0,this.lastRequestTime=c.performance.now(),this.timer=void 0}function e(a,b,c){return new d(a,b,c)}return a.extend(d.prototype,{matches:function(a){return a.match(this.pattern)},add:function(a,b){this.queue.push({config:a,deferred:b}),this.processQueue()},scheduleProcessing:function(){if(!a.isDefined(this.interval)){var d=Math.max(0,this.timeLimit-(c.performance.now()-this.lastRequestTime));this.timer=b(function(){this.timer=void 0,this.processQueue()}.bind(this),d)}},processQueue:function(){for(;this.queue.length;){if(!this.canProcess())return void this.scheduleProcessing();var a=this.queue.shift();a.deferred.resolve(a.config)}},canProcess:function(){var a=c.performance.now(),b=a-this.lastRequestTime;return b>=this.timeLimit&&(this.lastRequestTime=a,this.count=0),this.count<this.requestLimit?(this.count++,!0):!1}}),e}]).provider("ngHttpRateLimiterConfig",function(){var a=[],b=[];this.addLimiter=function(b,c,d){a.push({pattern:b,requestLimit:c,timeLimit:d})},this.$get=["ngHttpRateLimiterQueue",function(c){for(;a.length;){var d=a.shift();b.push(c(d.pattern,d.requestLimit,d.timeLimit))}return{getLimiters:function(){return b}}}]}).factory("ngHttpRateLimiterInterceptor",["$q","ngHttpRateLimiterConfig",function(a,b){return{request:function(c){var d=_.find(b.getLimiters(),function(a){return a.matches(c.url)});if(d){var e=a.defer();return d.add(c,e),e.promise}return c}}}])});